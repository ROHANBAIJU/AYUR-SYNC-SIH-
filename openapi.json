{"openapi":"3.1.0","info":{"title":"NAMASTE-ICD API","version":"0.1.0"},"paths":{"/":{"get":{"summary":"Read Root","operationId":"read_root__get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/api/auth/token":{"post":{"tags":["Authentication"],"summary":"Login For Access Token","description":"Authenticates the admin user and returns a JWT access token.\nThe admin panel will call this endpoint with username and password.","operationId":"login_for_access_token_api_auth_token_post","requestBody":{"content":{"application/x-www-form-urlencoded":{"schema":{"$ref":"#/components/schemas/Body_login_for_access_token_api_auth_token_post"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Token"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/auth/demo/signup":{"post":{"tags":["Authentication"],"summary":"Sign Up Demo Emr User","description":"Registers a new demo EMR user into CSV storage and returns a JWT token.\n- CSV file: data/demo frontend users/user_demo_frontend.csv\n- Columns: user_id, name, email, password\nConsole logs: issued token and confirmation of CSV append.","operationId":"sign_up_demo_emr_user_api_auth_demo_signup_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/DemoSignUpRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Token"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/auth/demo/signin":{"post":{"tags":["Authentication"],"summary":"Sign In Demo Emr User","description":"Authenticates an existing demo EMR user from CSV storage and returns a JWT token.\nConsole logs: issued token. If user not found, prompts to sign up via error.","operationId":"sign_in_demo_emr_user_api_auth_demo_signin_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/DemoSignInRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Token"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/admin/verify":{"post":{"tags":["Admin Panel"],"summary":"Verify Mapping","description":"Mark a mapping as verified and log audit.\n\nLookup precedence: code if provided else term.","operationId":"verify_mapping_api_admin_verify_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/VerifyPayload"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"OAuth2PasswordBearer":[]}]}},"/api/admin/force-verify":{"post":{"tags":["Admin Panel"],"summary":"Force Verify","description":"Force-create (or upgrade) a mapping directly to verified.\n\nUse this when the AI verify flow hasn't produced a DB row yet. If the ICD or term\ndoes not exist they are created. Primary selection: first verified mapping per\nICD/system becomes primary, others become aliases.","operationId":"force_verify_api_admin_force_verify_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/VerifyPayload"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"OAuth2PasswordBearer":[]}]}},"/api/admin/debug/icd-mappings":{"get":{"tags":["Admin Panel"],"summary":"Debug Icd Mappings","description":"Return all mappings (any status) for an ICD, grouped by system for debugging.","operationId":"debug_icd_mappings_api_admin_debug_icd_mappings_get","parameters":[{"name":"icd_name","in":"query","required":true,"schema":{"type":"string","title":"Icd Name"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/admin/analytics/summary":{"get":{"tags":["Admin Panel"],"summary":"Analytics Summary","operationId":"analytics_summary_api_admin_analytics_summary_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/api/admin/analytics/timeseries":{"get":{"tags":["Admin Panel"],"summary":"Analytics Timeseries","operationId":"analytics_timeseries_api_admin_analytics_timeseries_get","parameters":[{"name":"bucket","in":"query","required":false,"schema":{"type":"string","default":"minute","title":"Bucket"}},{"name":"limit","in":"query","required":false,"schema":{"type":"integer","default":1440,"title":"Limit"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/admin/analytics/recent":{"get":{"tags":["Admin Panel"],"summary":"Analytics Recent","operationId":"analytics_recent_api_admin_analytics_recent_get","parameters":[{"name":"limit","in":"query","required":false,"schema":{"type":"integer","default":100,"title":"Limit"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/admin/analytics/paths":{"get":{"tags":["Admin Panel"],"summary":"Analytics By Path","operationId":"analytics_by_path_api_admin_analytics_paths_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/api/admin/analytics/map/clusters":{"get":{"tags":["Admin Panel"],"summary":"Analytics Map Clusters","description":"Returns clustered counts within the given bounding box using a simple grid-based\nclustering by rounding lat/lon to a precision based on zoom.","operationId":"analytics_map_clusters_api_admin_analytics_map_clusters_get","parameters":[{"name":"bbox","in":"query","required":true,"schema":{"type":"string","title":"Bbox"}},{"name":"zoom","in":"query","required":false,"schema":{"type":"integer","default":5,"title":"Zoom"}},{"name":"system","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"System"}},{"name":"date_from","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Date From"}},{"name":"date_to","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Date To"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/admin/analytics/map/details":{"get":{"tags":["Admin Panel"],"summary":"Analytics Map Details","description":"Returns detailed events around a point (lat,lng) within a tolerance radius (box).","operationId":"analytics_map_details_api_admin_analytics_map_details_get","parameters":[{"name":"lat","in":"query","required":true,"schema":{"type":"number","title":"Lat"}},{"name":"lng","in":"query","required":true,"schema":{"type":"number","title":"Lng"}},{"name":"tolerance","in":"query","required":false,"schema":{"type":"number","default":0.01,"title":"Tolerance"}},{"name":"system","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"System"}},{"name":"date_from","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Date From"}},{"name":"date_to","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Date To"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/admin/debug-statuses":{"get":{"tags":["Admin Panel"],"summary":"Debug Statuses","description":"TEMPORARY ENDPOINT: Fetches the first 10 statuses directly from the\nmappings table to verify the result of the reset process.","operationId":"debug_statuses_api_admin_debug_statuses_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/api/admin/all-icd-codes-for-search":{"get":{"tags":["Admin Panel"],"summary":"Get All Icd Codes For Search","description":"DB-DRIVEN: Provides a comprehensive, unique, and sorted list of all ICD names\ndirectly from the icd11_codes table for use in search dropdowns.","operationId":"get_all_icd_codes_for_search_api_admin_all_icd_codes_for_search_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/api/admin/verified-icd-names":{"get":{"tags":["Admin Panel"],"summary":"Get Verified Icd Names","description":"Returns a simple list of ICD-11 names which currently have at least one\nverified mapping. Useful for indicating what can be translated/lookuped.","operationId":"get_verified_icd_names_api_admin_verified_icd_names_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/api/admin/remap-rejected-term":{"post":{"tags":["Admin Panel"],"summary":"Remap Rejected Term","operationId":"remap_rejected_term_api_admin_remap_rejected_term_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/RemapPayload"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/admin/reset-curation":{"post":{"tags":["Admin Panel"],"summary":"Reset Curation","operationId":"reset_curation_api_admin_reset_curation_post","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}},"security":[{"OAuth2PasswordBearer":[]}]}},"/api/admin/stats":{"get":{"tags":["Admin Panel"],"summary":"Get Stats","description":"DB-DRIVEN: Returns counts for the dashboard cards.\n- review: number of ICD codes that currently have at least one 'suggested' mapping\n- master_map: number of ICD codes that currently have at least one 'staged' mapping\n- rejected: total number of rejected mappings (correction + orphan)","operationId":"get_stats_api_admin_stats_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/api/admin/completeness-stats":{"get":{"tags":["Admin Panel"],"summary":"Get Completeness Stats","description":"DB-DRIVEN: Computes how many suggested ICDs have suggestions from\n3 systems, 2 systems, or 1 system.","operationId":"get_completeness_stats_api_admin_completeness_stats_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/api/admin/all-suggestions":{"get":{"tags":["Admin Panel"],"summary":"Get All Suggestions","description":"DB-DRIVEN & CORRECTLY FORMATTED: Fetches all suggestions from the database,\ngroups them by ICD-11 code, and casts the JSON suggestions to strings\nto match the format expected by the frontend.","operationId":"get_all_suggestions_api_admin_all_suggestions_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/api/admin/submit-curation":{"post":{"tags":["Admin Panel"],"summary":"Submit Curation","description":"DB-DRIVEN: Processes curation decisions from the frontend and updates the status\nof mappings in the database (from 'suggested' to 'staged' or 'rejected').","operationId":"submit_curation_api_admin_submit_curation_post","requestBody":{"content":{"application/json":{"schema":{"items":{"$ref":"#/components/schemas/CurationPayload"},"type":"array","title":"Curation Data"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/admin/curation-audit-log":{"post":{"tags":["Admin Panel"],"summary":"Curation Audit Log","description":"Persist lightweight audit events related to curation UI automation.\n\nCurrently stores each event as a MappingAudit row if a concrete mapping can\nbe resolved. Non-resolvable events are ignored (best-effort) to avoid 422\nfailures impacting user workflow.","operationId":"curation_audit_log_api_admin_curation_audit_log_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CurationAuditPayload"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"OAuth2PasswordBearer":[]}]}},"/api/admin/master-map-data":{"get":{"tags":["Admin Panel"],"summary":"Get Master Map Data","description":"DB-DRIVEN (FINAL CORRECTED VERSION): Correctly aggregates primary and alias\nterms for the master map using robust JSON functions.","operationId":"get_master_map_data_api_admin_master_map_data_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/api/admin/undo-verification":{"post":{"tags":["Admin Panel"],"summary":"Undo Verification","description":"DB-DRIVEN: Reverts a 'verified' mapping back to 'staged' for a given ICD code.","operationId":"undo_verification_api_admin_undo_verification_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UndoPayload"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/admin/rejected-mappings":{"get":{"tags":["Admin Panel"],"summary":"Get Rejected Mappings","description":"DB-DRIVEN: Fetches all rejected mappings from the database, separating them\ninto the 'Correction Queue' and the 'Orphanage'.","operationId":"get_rejected_mappings_api_admin_rejected_mappings_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/api/admin/commit-to-master":{"post":{"tags":["Admin Panel"],"summary":"Commit To Master","description":"DB-DRIVEN: Commits all 'staged' mappings by updating their status to 'verified'.","operationId":"commit_to_master_api_admin_commit_to_master_post","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/api/admin/update-rejected-mapping":{"post":{"tags":["Admin Panel"],"summary":"Update Rejected Mapping","operationId":"update_rejected_mapping_api_admin_update_rejected_mapping_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/RejectedUpdatePayload"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"OAuth2PasswordBearer":[]}]}},"/api/admin/update-master-mapping":{"post":{"tags":["Admin Panel"],"summary":"Update Master Mapping","description":"DB-DRIVEN (REWRITTEN): A robust version that correctly handles creating,\nupdating, and deleting terms and their mappings from the editor modal.","operationId":"update_master_mapping_api_admin_update_master_mapping_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/MasterUpdatePayload"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/admin/verify-mapping-with-ai":{"post":{"tags":["Admin Panel"],"summary":"Verify Mapping With Ai","description":"Runs AI justification AND persists the verified primary mapping to the database.\n\nFrontend sends: { icd_name, system, mapping: { primary: {...}, aliases?: [...] } }\nWe:\n  1. Run get_gemini_verification for justification/confidence.\n  2. Upsert ICD11Code (must already exist normally; create if missing for safety).\n  3. Upsert TraditionalTerm for the primary (match on system+code if code given, else system+term).\n  4. Create/Update Mapping row -> status='verified', determine is_primary.\n  5. Log MappingAudit action 'verify'.","operationId":"verify_mapping_with_ai_api_admin_verify_mapping_with_ai_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/AIVerifyPayload"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"OAuth2PasswordBearer":[]}]}},"/api/admin/revert-master-mapping":{"post":{"tags":["Admin Panel"],"summary":"Revert Master Mapping","description":"DB-DRIVEN: Reverts curated mappings for this ICD code back to 'suggested'.\nNow robust: handles both 'staged' and 'verified' statuses atomically.","operationId":"revert_master_mapping_api_admin_revert_master_mapping_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/RevertPayload"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/admin/icd-master-list":{"get":{"tags":["Admin Panel"],"summary":"Get Icd Master List","description":"DB-DRIVEN (CORRECTED): Fetches all ICD-11 codes, determines their\nstatus, and converts the result to a standard list of dicts for FastAPI.\nAn ICD is considered \"Mapped\" if it has at least one mapping with\nstatus 'staged' OR 'verified'.","operationId":"get_icd_master_list_api_admin_icd_master_list_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/api/admin/enrich-icd-from-who":{"post":{"tags":["Admin Panel"],"summary":"Enrich Icd From Who","description":"Enrich a single ICD-11 entry with WHO code and definition, regardless of verification state.\nUseful when search results return code/title but the definition requires a follow-up fetch.","operationId":"enrich_icd_from_who_api_admin_enrich_icd_from_who_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/EnrichICDPayload"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/admin/add-icd-code":{"post":{"tags":["Admin Panel"],"summary":"Add Icd Code","description":"Create a new ICD-11 entry (DB authoritative).\n\nFixes prior duplicate route conflict where a CSV-only version swallowed the\nrequest so new codes failed to appear in the DB-driven master list.","operationId":"add_icd_code_api_admin_add_icd_code_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ICDAddPayload"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"OAuth2PasswordBearer":[]}]}},"/api/admin/fetch-who-description":{"post":{"tags":["Admin Panel"],"summary":"Fetch Who Description","operationId":"fetch_who_description_api_admin_fetch_who_description_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/DescriptionFetchPayload"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"OAuth2PasswordBearer":[]}]}},"/api/admin/fetch-ai-description":{"post":{"tags":["Admin Panel"],"summary":"Fetch Ai Description","operationId":"fetch_ai_description_api_admin_fetch_ai_description_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/AIFetchPayload"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"OAuth2PasswordBearer":[]}]}},"/api/admin/all-traditional-terms":{"get":{"tags":["Admin Panel"],"summary":"Get All Traditional Terms","operationId":"get_all_traditional_terms_api_admin_all_traditional_terms_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}},"security":[{"OAuth2PasswordBearer":[]}]}},"/api/admin/update-manual-mapping":{"post":{"tags":["Admin Panel"],"summary":"Update Manual Mapping","operationId":"update_manual_mapping_api_admin_update_manual_mapping_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ManualMappingPayload"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"OAuth2PasswordBearer":[]}]}},"/api/admin/send-for-re-curation":{"post":{"tags":["Admin Panel"],"summary":"Send For Re Curation","operationId":"send_for_re_curation_api_admin_send_for_re_curation_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ReCurationPayload"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"OAuth2PasswordBearer":[]}]}},"/api/admin/remap-traditional-term":{"post":{"tags":["Admin Panel"],"summary":"Remap Traditional Term","operationId":"remap_traditional_term_api_admin_remap_traditional_term_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/RemapTermPayload"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"OAuth2PasswordBearer":[]}]}},"/api/admin/debug-mappings":{"get":{"tags":["Admin Panel"],"summary":"Debug Mappings","description":"TEMPORARY ENDPOINT to diagnose data integrity issues in the mappings table.","operationId":"debug_mappings_api_admin_debug_mappings_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/api/admin/debug-routes":{"get":{"tags":["Admin Panel"],"summary":"List Admin Routes","description":"TEMP: List registered admin router paths & methods to diagnose missing endpoints.","operationId":"list_admin_routes_api_admin_debug_routes_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/api/admin/deep-reset":{"post":{"tags":["Admin Panel"],"summary":"Deep Reset","description":"Trigger the overall destructive deep reset. Returns 409 if already running.","operationId":"deep_reset_api_admin_deep_reset_post","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}},"security":[{"OAuth2PasswordBearer":[]}]}},"/api/admin/deep-reset-status":{"get":{"tags":["Admin Panel"],"summary":"Deep Reset Status","operationId":"deep_reset_status_api_admin_deep_reset_status_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/api/public/lookup":{"get":{"tags":["Public EMR Endpoints"],"summary":"Lookup Term","description":"Unified lookup: accepts ICD code/name or traditional code/name (any system).\nBehavior:\n- If query looks like a NAMASTE code (e.g., ABC-123), search TraditionalTerm.code.\n- Else try exact ICD code match if pattern like A00.0 etc., then ICD name like.\n- Else do broad LIKE across traditional term names and ICD names.\nAlways returns ICD-centric grouping with verified mappings, acting as an 'expand' as well.","operationId":"lookup_term_api_public_lookup_get","parameters":[{"name":"query","in":"query","required":true,"schema":{"type":"string","minLength":2,"description":"Search across ICD-11 names/codes and traditional names/codes.","title":"Query"},"description":"Search across ICD-11 names/codes and traditional names/codes."},{"name":"system","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"description":"Optional system hint (ayurveda|siddha|unani).","title":"System"},"description":"Optional system hint (ayurveda|siddha|unani)."},{"name":"authorization","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Authorization"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/LookupResult"},"title":"Response Lookup Term Api Public Lookup Get"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/public/translate":{"get":{"tags":["Public EMR Endpoints"],"summary":"Translate Code","description":"Translate endpoint behavior:\n- If icd_name is provided: use it to fetch WHO ICD/TM2 details and assemble\n  traditional system mappings from VERIFIED DB for that ICD.\n- Else: use (system, code) to locate the VERIFIED mapping, derive the ICD name,\n  then fetch WHO details for that ICD name.\n\nIn all cases, WHO is queried with the ICD disease name, not the NAMASTE code.","operationId":"translate_code_api_public_translate_get","parameters":[{"name":"system","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"description":"The source traditional medicine system (e.g., 'ayurveda').","title":"System"},"description":"The source traditional medicine system (e.g., 'ayurveda')."},{"name":"code","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"description":"The source NAMASTE code (e.g., 'AKK-12').","title":"Code"},"description":"The source NAMASTE code (e.g., 'AKK-12')."},{"name":"icd_name","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"description":"ICD-11 disease name to enrich via WHO; preferred for WHO lookups.","title":"Icd Name"},"description":"ICD-11 disease name to enrich via WHO; preferred for WHO lookups."},{"name":"release","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"description":"ICD-11 linearization release to target (e.g., '2025-01').","title":"Release"},"description":"ICD-11 linearization release to target (e.g., '2025-01')."},{"name":"fhir","in":"query","required":false,"schema":{"type":"boolean","description":"If true, wrap successful response as FHIR Parameters resource.","default":false,"title":"Fhir"},"description":"If true, wrap successful response as FHIR Parameters resource."},{"name":"authorization","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Authorization"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/TranslateResult"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/public/translate/reverse":{"get":{"tags":["Public EMR Endpoints"],"summary":"Reverse Translate","operationId":"reverse_translate_api_public_translate_reverse_get","parameters":[{"name":"icd_name","in":"query","required":true,"schema":{"type":"string","description":"ICD-11 disease name to reverse translate into traditional systems.","title":"Icd Name"},"description":"ICD-11 disease name to reverse translate into traditional systems."},{"name":"release","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"description":"Reserved: specific release version (ignored for now).","title":"Release"},"description":"Reserved: specific release version (ignored for now)."},{"name":"fhir","in":"query","required":false,"schema":{"type":"boolean","description":"If true, wrap successful response as FHIR Parameters resource.","default":false,"title":"Fhir"},"description":"If true, wrap successful response as FHIR Parameters resource."},{"name":"authorization","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Authorization"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/TranslateResult"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/public/translate/cache/stats":{"get":{"tags":["Public EMR Endpoints"],"summary":"Translation Cache Stats","operationId":"translation_cache_stats_api_public_translate_cache_stats_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/api/public/verified-icd":{"get":{"tags":["Public EMR Endpoints"],"summary":"List Verified Icd","description":"Return distinct ICD names that have at least one verified mapping.","operationId":"list_verified_icd_api_public_verified_icd_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/api/public/mapping-search":{"get":{"tags":["Public EMR Endpoints"],"summary":"Mapping Search","operationId":"mapping_search_api_public_mapping_search_get","parameters":[{"name":"q","in":"query","required":true,"schema":{"type":"string","description":"Free text fragment to search traditional term or ICD name (verified only).","title":"Q"},"description":"Free text fragment to search traditional term or ICD name (verified only)."},{"name":"limit","in":"query","required":false,"schema":{"type":"integer","maximum":100,"minimum":1,"default":25,"title":"Limit"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/fhir/metadata":{"get":{"tags":["FHIR"],"summary":"Capability Statement","description":"Enhanced CapabilityStatement advertising full implemented surface.","operationId":"capability_statement_api_fhir_metadata_get","parameters":[{"name":"authorization","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Authorization"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/fhir/CodeSystem/$lookup":{"get":{"tags":["FHIR"],"summary":"Codesystem Lookup","operationId":"codesystem_lookup_api_fhir_CodeSystem__lookup_get","parameters":[{"name":"system","in":"query","required":true,"schema":{"type":"string","description":"CodeSystem URL or key (ayurveda|siddha|unani)","title":"System"},"description":"CodeSystem URL or key (ayurveda|siddha|unani)"},{"name":"code","in":"query","required":true,"schema":{"type":"string","description":"Code to look up (NAMASTE code)","title":"Code"},"description":"Code to look up (NAMASTE code)"},{"name":"release","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"description":"ConceptMap release version to scope (verified mappings snapshot).","title":"Release"},"description":"ConceptMap release version to scope (verified mappings snapshot)."},{"name":"authorization","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Authorization"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/fhir/CodeSystem/{system_key}":{"get":{"tags":["FHIR"],"summary":"Get Code System","operationId":"get_code_system_api_fhir_CodeSystem__system_key__get","parameters":[{"name":"system_key","in":"path","required":true,"schema":{"type":"string","title":"System Key"}},{"name":"authorization","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Authorization"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/fhir/Bundle":{"post":{"tags":["FHIR"],"summary":"Ingest Bundle","description":"Prototype Bundle ingest.\n\nAccepts a JSON body representing a simplified FHIR Bundle:\n{\n  \"resourceType\": \"Bundle\",\n  \"type\": \"collection\",\n  \"entry\": [{\"resource\": {\"resourceType\": \"Condition\", ...}}, ...]\n}\n\nClassifies each Condition as valid / mismatch / unknown based on:\n- NAMASTE (source) term -> verified ICD mapping presence\n- Provided ICD code/display alignment with stored ICD name\nReturns an OperationOutcome-like summary structure.","operationId":"ingest_bundle_api_fhir_Bundle_post","parameters":[{"name":"release","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"description":"Optional ConceptMap release version to validate against (defaults to latest).","title":"Release"},"description":"Optional ConceptMap release version to validate against (defaults to latest)."},{"name":"authorization","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Authorization"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","additionalProperties":true,"title":"Payload"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/fhir/ValueSet/$expand":{"get":{"tags":["FHIR"],"summary":"Valueset Expand","operationId":"valueset_expand_api_fhir_ValueSet__expand_get","parameters":[{"name":"system","in":"query","required":true,"schema":{"type":"string","description":"CodeSystem URL or key (ayurveda|siddha|unani)","title":"System"},"description":"CodeSystem URL or key (ayurveda|siddha|unani)"},{"name":"filter","in":"query","required":false,"schema":{"anyOf":[{"type":"string","minLength":2},{"type":"null"}],"description":"Text filter against term/description","title":"Filter"},"description":"Text filter against term/description"},{"name":"count","in":"query","required":false,"schema":{"type":"integer","maximum":200,"minimum":1,"default":25,"title":"Count"}},{"name":"release","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"description":"ConceptMap release version to scope expansion.","title":"Release"},"description":"ConceptMap release version to scope expansion."},{"name":"authorization","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Authorization"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/fhir/ConceptMap/$translate":{"get":{"tags":["FHIR"],"summary":"Conceptmap Translate","operationId":"conceptmap_translate_api_fhir_ConceptMap__translate_get","parameters":[{"name":"system","in":"query","required":true,"schema":{"type":"string","description":"Source CodeSystem URL or key (ayurveda|siddha|unani)","title":"System"},"description":"Source CodeSystem URL or key (ayurveda|siddha|unani)"},{"name":"code","in":"query","required":true,"schema":{"type":"string","description":"Source code (NAMASTE) OR (fallback) the term itself","title":"Code"},"description":"Source code (NAMASTE) OR (fallback) the term itself"},{"name":"target","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"description":"Optional target system URI (defaults to ICD-11 MMS)","title":"Target"},"description":"Optional target system URI (defaults to ICD-11 MMS)"},{"name":"release","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"description":"ConceptMap release version to scope translation.","title":"Release"},"description":"ConceptMap release version to scope translation."},{"name":"authorization","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Authorization"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/fhir/ConceptMap/translate":{"get":{"tags":["FHIR"],"summary":"Conceptmap Translate","operationId":"conceptmap_translate_api_fhir_ConceptMap_translate_get","parameters":[{"name":"system","in":"query","required":true,"schema":{"type":"string","description":"Source CodeSystem URL or key (ayurveda|siddha|unani)","title":"System"},"description":"Source CodeSystem URL or key (ayurveda|siddha|unani)"},{"name":"code","in":"query","required":true,"schema":{"type":"string","description":"Source code (NAMASTE) OR (fallback) the term itself","title":"Code"},"description":"Source code (NAMASTE) OR (fallback) the term itself"},{"name":"target","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"description":"Optional target system URI (defaults to ICD-11 MMS)","title":"Target"},"description":"Optional target system URI (defaults to ICD-11 MMS)"},{"name":"release","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"description":"ConceptMap release version to scope translation.","title":"Release"},"description":"ConceptMap release version to scope translation."},{"name":"authorization","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Authorization"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/public/diagnosis":{"post":{"tags":["Public EMR Endpoints"],"summary":"Log Diagnosis Event","operationId":"log_diagnosis_event_api_public_diagnosis_post","parameters":[{"name":"authorization","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Authorization"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/DiagnosisEventPayload"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/admin/conceptmap/releases":{"get":{"tags":["ConceptMap","conceptmap"],"summary":"List Releases","operationId":"list_releases_api_admin_conceptmap_releases_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/api/admin/conceptmap/releases/latest":{"get":{"tags":["ConceptMap","conceptmap"],"summary":"Latest Release","operationId":"latest_release_api_admin_conceptmap_releases_latest_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/api/admin/conceptmap/releases/{version}/elements":{"get":{"tags":["ConceptMap","conceptmap"],"summary":"Elements","operationId":"elements_api_admin_conceptmap_releases__version__elements_get","parameters":[{"name":"version","in":"path","required":true,"schema":{"type":"string","title":"Version"}},{"name":"icd_name","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Icd Name"}},{"name":"system","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"System"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/admin/conceptmap/releases/{version}/diff":{"get":{"tags":["ConceptMap","conceptmap"],"summary":"Diff Release","description":"Compute a structural diff of ConceptMapElements between two releases.\n\nIf `from_version` omitted, uses the chronologically previous release (by created_at) as baseline.\nDiff semantics:\n  Key = (system, term, icd_name) – this trio defines a mapping association.\n  Added: present in target, not in baseline.\n  Removed: present in baseline, not in target.\n  Changed: present in both but differing in at least one of: icd_code, equivalence, is_primary, active.","operationId":"diff_release_api_admin_conceptmap_releases__version__diff_get","parameters":[{"name":"version","in":"path","required":true,"schema":{"type":"string","title":"Version"}},{"name":"from_version","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"From Version"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/admin/conceptmap/releases/{version}/refresh":{"post":{"tags":["ConceptMap","conceptmap"],"summary":"Refresh Release","description":"Rebuild (or create) a ConceptMap release snapshot from current verified mappings.\n\nSteps:\n  1. Find (or create) the release row.\n  2. Delete existing ConceptMapElement rows for that release.\n  3. Query all verified mappings (primary + aliases) and insert as elements.\n  4. Return summary counts.\n\nThis lets you verify mappings via /api/admin/verify then call this endpoint\nwithout restarting the server to expose them to FHIR $translate and provenance.","operationId":"refresh_release_api_admin_conceptmap_releases__version__refresh_post","parameters":[{"name":"version","in":"path","required":true,"schema":{"type":"string","title":"Version"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/admin/conceptmap/releases/{version}/fhir":{"get":{"tags":["ConceptMap","conceptmap"],"summary":"Export Fhir Conceptmap","description":"Export a ConceptMap release as a FHIR ConceptMap resource.\n\nParameters:\n  version: release version string\n  summary: if true, omit heavy group.element arrays (provides counts only)","operationId":"export_fhir_conceptmap_api_admin_conceptmap_releases__version__fhir_get","parameters":[{"name":"version","in":"path","required":true,"schema":{"type":"string","title":"Version"}},{"name":"summary","in":"query","required":false,"schema":{"type":"boolean","default":false,"title":"Summary"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/status":{"get":{"tags":["Status","Status"],"summary":"System Status","operationId":"system_status_api_status_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/api/fhir/provenance/conceptmap":{"get":{"tags":["Provenance","Provenance"],"summary":"Provenance For Mapping","operationId":"provenance_for_mapping_api_fhir_provenance_conceptmap_get","parameters":[{"name":"icd_name","in":"query","required":true,"schema":{"type":"string","description":"ICD name to inspect","title":"Icd Name"},"description":"ICD name to inspect"},{"name":"system","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"description":"Filter by traditional system (ayurveda|siddha|unani)","title":"System"},"description":"Filter by traditional system (ayurveda|siddha|unani)"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/fhir/provenance/conceptmap/release/{version}":{"get":{"tags":["Provenance","Provenance"],"summary":"Provenance Bundle For Release","operationId":"provenance_bundle_for_release_api_fhir_provenance_conceptmap_release__version__get","parameters":[{"name":"version","in":"path","required":true,"schema":{"type":"string","title":"Version"}},{"name":"limit","in":"query","required":false,"schema":{"type":"integer","maximum":2000,"minimum":1,"default":500,"title":"Limit"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/fhir/provenance/mapping/{mapping_id}":{"get":{"tags":["Provenance","Provenance"],"summary":"Provenance For Mapping Id","operationId":"provenance_for_mapping_id_api_fhir_provenance_mapping__mapping_id__get","parameters":[{"name":"mapping_id","in":"path","required":true,"schema":{"type":"integer","title":"Mapping Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/admin/analytics/morbidity/top":{"get":{"tags":["Analytics","analytics"],"summary":"Top Morbidity","operationId":"top_morbidity_api_admin_analytics_morbidity_top_get","parameters":[{"name":"limit","in":"query","required":false,"schema":{"type":"integer","maximum":50,"minimum":1,"default":10,"title":"Limit"}},{"name":"days","in":"query","required":false,"schema":{"type":"integer","maximum":365,"minimum":1,"default":30,"title":"Days"}},{"name":"authorization","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Authorization"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/admin/analytics/dual-coding/coverage":{"get":{"tags":["Analytics","analytics"],"summary":"Dual Coding Coverage","operationId":"dual_coding_coverage_api_admin_analytics_dual_coding_coverage_get","parameters":[{"name":"days","in":"query","required":false,"schema":{"type":"integer","maximum":365,"minimum":1,"default":30,"title":"Days"}},{"name":"authorization","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Authorization"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/admin/external/links":{"get":{"tags":["External Semantics","External Semantics"],"summary":"List Links","operationId":"list_links_api_admin_external_links_get","parameters":[{"name":"system","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"description":"External system (snomed|loinc)","title":"System"},"description":"External system (snomed|loinc)"},{"name":"source_type","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"description":"Source type (icd11|namaste)","title":"Source Type"},"description":"Source type (icd11|namaste)"},{"name":"code","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"description":"Filter by source code fragment","title":"Code"},"description":"Filter by source code fragment"},{"name":"authorization","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Authorization"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/admin/ingest/_debug_fingerprint":{"get":{"tags":["Ingestion","ingestion"],"summary":" Debug Fingerprint","operationId":"_debug_fingerprint_api_admin_ingest__debug_fingerprint_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/api/admin/ingest/_debug_routes":{"get":{"tags":["Ingestion","ingestion"],"summary":" Debug Routes","operationId":"_debug_routes_api_admin_ingest__debug_routes_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/api/admin/ingest/upload":{"post":{"tags":["Ingestion","ingestion"],"summary":"Upload Suggestions","description":"Upload a suggestions file (CSV or Excel) and stage rows.\n\nEnhancements:\n    - Supports .csv, .tsv, .xls, .xlsx\n    - Optional enrichment stub (if enabled) now ONLY assigns placeholder ICD name (Title Case of term) when missing.\n    - We NO LONGER auto-fill ai_confidence / ai_justification. Those fields remain in schema for legacy rows.","operationId":"upload_suggestions_api_admin_ingest_upload_post","requestBody":{"content":{"multipart/form-data":{"schema":{"$ref":"#/components/schemas/Body_upload_suggestions_api_admin_ingest_upload_post"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"OAuth2PasswordBearer":[]}]}},"/api/admin/ingest/batches":{"get":{"tags":["Ingestion","ingestion"],"summary":"List Batches","operationId":"list_batches_api_admin_ingest_batches_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}},"security":[{"OAuth2PasswordBearer":[]}]}},"/api/admin/ingest/batches/{batch_id}/rows":{"get":{"tags":["Ingestion","ingestion"],"summary":"Batch Rows","description":"List staging rows with optional filtering.\n\nFilters:\n  - q: substring search (case-insensitive) over source_term\n  - status: pending|promoted|rejected\n  - system: ayurveda|siddha|unani\n  - min_conf: minimum ai_confidence (integer)","operationId":"batch_rows_api_admin_ingest_batches__batch_id__rows_get","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"batch_id","in":"path","required":true,"schema":{"type":"integer","title":"Batch Id"}},{"name":"limit","in":"query","required":false,"schema":{"type":"integer","default":500,"title":"Limit"}},{"name":"q","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Q"}},{"name":"status","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Status"}},{"name":"system","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"System"}},{"name":"min_conf","in":"query","required":false,"schema":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Min Conf"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/admin/ingest/batches/{batch_id}":{"delete":{"tags":["Ingestion","ingestion"],"summary":"Delete Batch","description":"Delete an ingestion batch and cascade delete its rows.","operationId":"delete_batch_api_admin_ingest_batches__batch_id__delete","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"batch_id","in":"path","required":true,"schema":{"type":"integer","title":"Batch Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/admin/ingest/rows/{row_id}":{"delete":{"tags":["Ingestion","ingestion"],"summary":"Delete Row","description":"Delete a single ingestion row (does not affect batch counters).","operationId":"delete_row_api_admin_ingest_rows__row_id__delete","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"row_id","in":"path","required":true,"schema":{"type":"integer","title":"Row Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/admin/ingest/rows/{row_id}/promote":{"post":{"tags":["Ingestion","ingestion"],"summary":"Promote Row","description":"Promote a staged row to a Mapping (status=suggested).","operationId":"promote_row_api_admin_ingest_rows__row_id__promote_post","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"row_id","in":"path","required":true,"schema":{"type":"integer","title":"Row Id"}}],"requestBody":{"content":{"application/x-www-form-urlencoded":{"schema":{"$ref":"#/components/schemas/Body_promote_row_api_admin_ingest_rows__row_id__promote_post"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/admin/ingest/rows/bulk_promote":{"post":{"tags":["Ingestion","ingestion"],"summary":"Bulk Promote","description":"Bulk promote multiple row IDs. Returns successes and errors.","operationId":"bulk_promote_api_admin_ingest_rows_bulk_promote_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/BulkRowIds"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"OAuth2PasswordBearer":[]}]}},"/api/admin/ingest/rows/{row_id}/reject":{"post":{"tags":["Ingestion","ingestion"],"summary":"Reject Row","operationId":"reject_row_api_admin_ingest_rows__row_id__reject_post","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"row_id","in":"path","required":true,"schema":{"type":"integer","title":"Row Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/admin/ingest/rows/bulk_reject":{"post":{"tags":["Ingestion","ingestion"],"summary":"Bulk Reject","operationId":"bulk_reject_api_admin_ingest_rows_bulk_reject_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/BulkRejectIds"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"OAuth2PasswordBearer":[]}]}},"/api/admin/who-sync/status":{"get":{"summary":"Who Sync Status","operationId":"who_sync_status_api_admin_who_sync_status_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/api/admin/who-sync/trigger":{"post":{"summary":"Who Sync Trigger","operationId":"who_sync_trigger_api_admin_who_sync_trigger_post","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}}},"components":{"schemas":{"AIFetchPayload":{"properties":{"icd_name":{"type":"string","title":"Icd Name"},"who_description":{"type":"string","title":"Who Description"}},"type":"object","required":["icd_name","who_description"],"title":"AIFetchPayload"},"AIVerifyPayload":{"properties":{"icd_name":{"type":"string","title":"Icd Name"},"system":{"type":"string","title":"System"},"mapping":{"additionalProperties":true,"type":"object","title":"Mapping"}},"type":"object","required":["icd_name","system","mapping"],"title":"AIVerifyPayload"},"Body_login_for_access_token_api_auth_token_post":{"properties":{"grant_type":{"anyOf":[{"type":"string","pattern":"^password$"},{"type":"null"}],"title":"Grant Type"},"username":{"type":"string","title":"Username"},"password":{"type":"string","format":"password","title":"Password"},"scope":{"type":"string","title":"Scope","default":""},"client_id":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Client Id"},"client_secret":{"anyOf":[{"type":"string"},{"type":"null"}],"format":"password","title":"Client Secret"}},"type":"object","required":["username","password"],"title":"Body_login_for_access_token_api_auth_token_post"},"Body_promote_row_api_admin_ingest_rows__row_id__promote_post":{"properties":{"primary":{"type":"boolean","title":"Primary","default":false}},"type":"object","title":"Body_promote_row_api_admin_ingest_rows__row_id__promote_post"},"Body_upload_suggestions_api_admin_ingest_upload_post":{"properties":{"file":{"type":"string","format":"binary","title":"File","description":"CSV/TSV/XLS/XLSX with columns: system, code, term, (optional) suggested_icd_name, short_definition, long_definition, vernacular_term"},"enrich_missing":{"type":"boolean","title":"Enrich Missing","default":true}},"type":"object","required":["file"],"title":"Body_upload_suggestions_api_admin_ingest_upload_post"},"BulkRejectIds":{"properties":{"row_ids":{"items":{"type":"integer"},"type":"array","title":"Row Ids"}},"type":"object","required":["row_ids"],"title":"BulkRejectIds"},"BulkRowIds":{"properties":{"row_ids":{"items":{"type":"integer"},"type":"array","title":"Row Ids"},"primary":{"anyOf":[{"type":"boolean"},{"type":"null"}],"title":"Primary"}},"type":"object","required":["row_ids"],"title":"BulkRowIds"},"CurationAuditEvent":{"properties":{"type":{"type":"string","title":"Type"},"icd_name":{"type":"string","title":"Icd Name"},"system":{"type":"string","title":"System"},"term":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Term"},"code":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Code"},"reason":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Reason"}},"type":"object","required":["type","icd_name","system"],"title":"CurationAuditEvent"},"CurationAuditPayload":{"properties":{"events":{"items":{"$ref":"#/components/schemas/CurationAuditEvent"},"type":"array","title":"Events"},"ts":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Ts"}},"type":"object","required":["events"],"title":"CurationAuditPayload"},"CurationPayload":{"properties":{"icd_name":{"type":"string","title":"Icd Name"},"statuses":{"additionalProperties":true,"type":"object","title":"Statuses"}},"type":"object","required":["icd_name","statuses"],"title":"CurationPayload"},"DemoSignInRequest":{"properties":{"email":{"type":"string","format":"email","title":"Email"},"password":{"type":"string","title":"Password"}},"type":"object","required":["email","password"],"title":"DemoSignInRequest"},"DemoSignUpRequest":{"properties":{"name":{"type":"string","title":"Name"},"email":{"type":"string","format":"email","title":"Email"},"password":{"type":"string","title":"Password"}},"type":"object","required":["name","email","password"],"title":"DemoSignUpRequest"},"DescriptionFetchPayload":{"properties":{"icd_name":{"type":"string","title":"Icd Name"}},"type":"object","required":["icd_name"],"title":"DescriptionFetchPayload"},"DiagnosisEventPayload":{"properties":{"doctor_id":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Doctor Id"},"system":{"type":"string","title":"System","description":"ayurveda | siddha | unani"},"code":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Code"},"term_name":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Term Name"},"icd_name":{"type":"string","title":"Icd Name"},"city":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"City"},"state":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"State"},"latitude":{"type":"number","title":"Latitude"},"longitude":{"type":"number","title":"Longitude"}},"type":"object","required":["system","icd_name","latitude","longitude"],"title":"DiagnosisEventPayload"},"EnrichICDPayload":{"properties":{"icd_name":{"type":"string","title":"Icd Name"},"release":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Release"}},"type":"object","required":["icd_name"],"title":"EnrichICDPayload"},"HTTPValidationError":{"properties":{"detail":{"items":{"$ref":"#/components/schemas/ValidationError"},"type":"array","title":"Detail"}},"type":"object","title":"HTTPValidationError"},"ICDAddPayload":{"properties":{"icd_name":{"type":"string","title":"Icd Name"},"description":{"type":"string","title":"Description"}},"type":"object","required":["icd_name","description"],"title":"ICDAddPayload"},"ICDEntry":{"properties":{"name":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Name"},"code":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Code"},"description":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Description"},"icd_uri":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Icd Uri"},"extra":{"additionalProperties":true,"type":"object","title":"Extra"}},"type":"object","required":["name","code","description","icd_uri"],"title":"ICDEntry"},"LookupResult":{"properties":{"icd_name":{"type":"string","title":"Icd Name"},"icd_description":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Icd Description"},"system_mappings":{"items":{"$ref":"#/components/schemas/SystemMapping"},"type":"array","title":"System Mappings"}},"type":"object","required":["icd_name","icd_description","system_mappings"],"title":"LookupResult"},"ManualMappingPayload":{"properties":{"icd_name":{"type":"string","title":"Icd Name"},"system":{"type":"string","title":"System"},"mapping":{"additionalProperties":true,"type":"object","title":"Mapping"},"destination":{"type":"string","title":"Destination"}},"type":"object","required":["icd_name","system","mapping","destination"],"title":"ManualMappingPayload"},"MasterUpdatePayload":{"properties":{"icd_name":{"type":"string","title":"Icd Name"},"system":{"type":"string","title":"System"},"mapping":{"additionalProperties":true,"type":"object","title":"Mapping"}},"type":"object","required":["icd_name","system","mapping"],"title":"MasterUpdatePayload"},"MatchedTerm":{"properties":{"term":{"type":"string","title":"Term"},"code":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Code"},"source_description":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Source Description"},"vernacular":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Vernacular"}},"type":"object","required":["term","code","source_description","vernacular"],"title":"MatchedTerm"},"ReCurationPayload":{"properties":{"new_icd_name":{"type":"string","title":"New Icd Name"},"original_icd_name":{"type":"string","title":"Original Icd Name"},"system":{"type":"string","title":"System"},"term_data":{"additionalProperties":true,"type":"object","title":"Term Data"}},"type":"object","required":["new_icd_name","original_icd_name","system","term_data"],"title":"ReCurationPayload"},"RejectedUpdatePayload":{"properties":{"original_icd_name":{"type":"string","title":"Original Icd Name"},"new_icd_name":{"type":"string","title":"New Icd Name"},"system":{"type":"string","title":"System"},"term":{"type":"string","title":"Term"}},"type":"object","required":["original_icd_name","new_icd_name","system","term"],"title":"RejectedUpdatePayload"},"RemapPayload":{"properties":{"rejected_term_data":{"additionalProperties":true,"type":"object","title":"Rejected Term Data"},"destination_icd_name":{"type":"string","title":"Destination Icd Name"},"is_new_icd":{"type":"boolean","title":"Is New Icd"}},"type":"object","required":["rejected_term_data","destination_icd_name","is_new_icd"],"title":"RemapPayload"},"RemapTermPayload":{"properties":{"term_data":{"additionalProperties":true,"type":"object","title":"Term Data"},"old_icd_name":{"type":"string","title":"Old Icd Name"},"new_icd_name":{"type":"string","title":"New Icd Name"},"target_system":{"type":"string","title":"Target System"}},"type":"object","required":["term_data","old_icd_name","new_icd_name","target_system"],"title":"RemapTermPayload"},"RevertPayload":{"properties":{"icd_name":{"type":"string","title":"Icd Name"}},"type":"object","required":["icd_name"],"title":"RevertPayload"},"SystemMapping":{"properties":{"system":{"type":"string","title":"System"},"primary_term":{"anyOf":[{"$ref":"#/components/schemas/MatchedTerm"},{"type":"null"}]},"aliases":{"items":{"$ref":"#/components/schemas/MatchedTerm"},"type":"array","title":"Aliases","default":[]}},"type":"object","required":["system"],"title":"SystemMapping"},"SystemMappingEntry":{"properties":{"primary":{"anyOf":[{"$ref":"#/components/schemas/SystemTerm"},{"type":"null"}]},"aliases":{"items":{"$ref":"#/components/schemas/SystemTerm"},"type":"array","title":"Aliases"}},"type":"object","title":"SystemMappingEntry"},"SystemTerm":{"properties":{"name":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Name"},"code":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Code"},"description":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Description"},"vernacular":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Vernacular"},"extra":{"additionalProperties":true,"type":"object","title":"Extra"}},"type":"object","required":["name","code","description"],"title":"SystemTerm"},"Token":{"properties":{"access_token":{"type":"string","title":"Access Token"},"token_type":{"type":"string","title":"Token Type"}},"type":"object","required":["access_token","token_type"],"title":"Token","description":"Schema for the JWT access token response."},"TranslateResult":{"properties":{"ayurveda":{"anyOf":[{"$ref":"#/components/schemas/SystemMappingEntry"},{"type":"null"}]},"siddha":{"anyOf":[{"$ref":"#/components/schemas/SystemMappingEntry"},{"type":"null"}]},"unani":{"anyOf":[{"$ref":"#/components/schemas/SystemMappingEntry"},{"type":"null"}]},"icd":{"anyOf":[{"$ref":"#/components/schemas/ICDEntry"},{"type":"null"}]},"tm2":{"anyOf":[{"$ref":"#/components/schemas/ICDEntry"},{"type":"null"}]},"release_version":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Release Version"},"direction":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Direction"}},"type":"object","title":"TranslateResult"},"UndoPayload":{"properties":{"icd_name":{"type":"string","title":"Icd Name"}},"type":"object","required":["icd_name"],"title":"UndoPayload"},"ValidationError":{"properties":{"loc":{"items":{"anyOf":[{"type":"string"},{"type":"integer"}]},"type":"array","title":"Location"},"msg":{"type":"string","title":"Message"},"type":{"type":"string","title":"Error Type"}},"type":"object","required":["loc","msg","type"],"title":"ValidationError"},"VerifyPayload":{"properties":{"icd_name":{"type":"string","title":"Icd Name"},"system":{"type":"string","title":"System"},"code":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Code"},"term":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Term"},"reason":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Reason"}},"type":"object","required":["icd_name","system"],"title":"VerifyPayload"}},"securitySchemes":{"OAuth2PasswordBearer":{"type":"oauth2","flows":{"password":{"scopes":{},"tokenUrl":"/api/auth/token"}}}}}}